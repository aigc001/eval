{"trg_prediction": "\n# Convert to PyTorch tensors\nids = torch.tensor(ids)\nx = torch.tensor(x)\n\n# Gather the selected slices\nresult = torch.gather(x, 1, ids.unsqueeze(-1).expand(-1, -1, x.shape[-1]))\n\n# Squeeze the last dimension\nresult = result.squeeze(1)\n"}