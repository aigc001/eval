{"trg_prediction": "\n    # Create a copy of the dataframe to avoid modifying the original one\n    df_copy = df.copy()\n\n    # Iterate over the columns\n    for col in df_copy.columns:\n        # Get the value counts for the column\n        counts = df_copy[col].value_counts()\n\n        # Get the values that appear at least 2 times\n        values_to_keep = counts[counts >= 2].index\n\n        # Replace the values that don't appear at least 2 times with 'other'\n        df_copy[col] = df_copy[col].apply(lambda x: 'other' if x not in values_to_keep else x)\n\n    return df_copy\n"}