{"trg_prediction": "\n# Get the index location of each respective column minimum\nmin_idx = df.idxmin()\n\n# Get the index location of each respective column maximum\nmax_idx = df.idxmax()\n\n# Create a mask where the max's after the minimum occurrence are ignored\nmask = (df.columns.values[:,None] == max_idx.values) & (df.index.values[:,None] > min_idx.values)\n\n# Apply the mask to get the index location of the last occurrence of the column-wise maximum, up to the location of the minimum\nresult = df.index[np.argmax(mask, axis=0)]\n\n# Create a DataFrame from the result\nresult_df = pd.DataFrame(result, index=df.columns, columns=['Last Max Before Min'])\n\nprint(result_df)\n"}